<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¡œë˜7 150ì¥ ìë™ ì œì¶œ</title>
  <style>
    body { font-family: 'Malgun Gothic', sans-serif; max-width: 900px; margin: 20px auto; padding: 20px; background: #f0f0f0; }
    h1 { color: #1565c0; text-align: center; }
    .batch { background: white; padding: 20px; margin: 15px 0; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .batch h3 { margin-top: 0; color: #1565c0; }
    button { background: #1565c0; color: white; border: none; padding: 15px 30px; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: bold; }
    button:hover { background: #0d47a1; }
    button.done { background: #4caf50; }
    .warning { background: #fff3e0; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 5px solid #ff9800; }
    .info { background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
    .tickets { font-family: monospace; font-size: 11px; max-height: 200px; overflow-y: auto; background: #f5f5f5; padding: 10px; border-radius: 5px; margin-top: 10px; }
    .ticket-line { padding: 2px 0; }
    .progress { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px; }
    .progress-item { padding: 8px 15px; background: #e0e0e0; border-radius: 20px; font-size: 14px; }
    .progress-item.done { background: #c8e6c9; color: #2e7d32; }
    /* ë‹¹ì²¨ í™•ì¸ ìŠ¤íƒ€ì¼ */
    .check-section {
      background: linear-gradient(135deg, #1565c0 0%, #0d47a1 100%);
      padding: 25px;
      border-radius: 15px;
      margin-bottom: 20px;
      color: white;
    }
    .check-section h2 {
      margin-top: 0;
      color: white;
    }
    .number-input {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin: 15px 0;
    }
    .number-input input {
      width: 45px;
      height: 45px;
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      border: 2px solid white;
      border-radius: 50%;
      background: rgba(255,255,255,0.9);
      color: #333;
    }
    .number-input input.bonus {
      border-color: #ffd700;
      background: #fff9c4;
    }
    .number-input label {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 11px;
    }
    .check-btn {
      background: #ffd700;
      color: #333;
      border: none;
      padding: 15px 40px;
      border-radius: 30px;
      cursor: pointer;
      font-size: 18px;
      font-weight: bold;
      margin-top: 10px;
    }
    .check-btn:hover {
      background: #ffeb3b;
    }
    .results {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
      color: #333;
      max-height: 500px;
      overflow-y: auto;
    }
    .result-summary {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }
    .result-card {
      background: #f5f5f5;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    .result-card.has-win {
      background: linear-gradient(135deg, #ffd700 0%, #ffeb3b 100%);
    }
    .result-card h4 {
      margin: 0;
      font-size: 14px;
      color: #666;
    }
    .result-card .count {
      font-size: 28px;
      font-weight: bold;
      color: #333;
    }
    .result-card .prize {
      font-size: 11px;
      color: #888;
    }
    .result-card .mini-scratch {
      position: relative;
      width: 70px;
      height: 35px;
      margin: 5px auto;
      border-radius: 5px;
      overflow: hidden;
    }
    .result-card .mini-scratch-content {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      font-weight: bold;
      visibility: hidden;
    }
    .result-card .mini-scratch-content.ready {
      visibility: visible;
    }
    .result-card .mini-scratch-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="8" fill="%23c0c0c0" stroke="%23888" stroke-width="2"/></svg>') 12 12, crosshair;
    }
    .winning-tickets {
      margin-top: 15px;
    }
    .winning-ticket {
      background: #e8f5e9;
      padding: 10px 15px;
      margin: 5px 0;
      border-radius: 8px;
      border-left: 4px solid #4caf50;
    }
    .winning-ticket .rank {
      font-weight: bold;
      color: #1565c0;
    }
    .winning-ticket .numbers {
      font-family: monospace;
    }
    .winning-ticket .matched {
      color: #d32f2f;
      font-weight: bold;
    }
    .total-prize {
      background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
      color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      margin-top: 15px;
    }
    .total-prize h3 {
      margin: 0;
      font-size: 16px;
    }
    .total-prize .amount {
      font-size: 32px;
      font-weight: bold;
    }
    /* ìŠ¤í¬ë˜ì¹˜ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
    .scratch-section {
      margin-top: 20px;
      padding: 20px;
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      border-radius: 15px;
    }
    .scratch-section h4 {
      color: #ffd700;
      margin-top: 0;
      text-align: center;
    }
    .scratch-cards {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }
    .scratch-card {
      width: 280px;
      height: 120px;
      position: relative;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      touch-action: none;
    }
    .scratch-content {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #fff9c4 0%, #fff176 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 10px;
      box-sizing: border-box;
      visibility: hidden;
    }
    .scratch-content.ready {
      visibility: visible;
    }
    .scratch-content .rank-text {
      font-size: 24px;
      font-weight: bold;
      color: #1565c0;
    }
    .scratch-content .ticket-info {
      font-size: 12px;
      color: #666;
      margin-top: 5px;
    }
    .scratch-content .numbers-text {
      font-family: monospace;
      font-size: 14px;
      margin-top: 8px;
      color: #333;
    }
    .scratch-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><circle cx="16" cy="16" r="12" fill="%23c0c0c0" stroke="%23888" stroke-width="2"/><circle cx="12" cy="12" r="3" fill="%23fff" opacity="0.5"/></svg>') 16 16, crosshair;
    }
    .reveal-all-btn {
      display: block;
      margin: 15px auto 0;
      background: #3498db;
      color: white;
      border: none;
      padding: 10px 25px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
    }
    .reveal-all-btn:hover {
      background: #2980b9;
    }
  </style>
</head>
<body>
  <h1>ğŸ° ë¡œë˜7 150ì¥ ìë™ ì œì¶œ</h1>

  <div class="warning">
    <strong>âš ï¸ ì¤‘ìš”!</strong><br>
    1. ë¨¼ì € <a href="https://takarakuji.rakuten.co.jp/loto/loto7/" target="_blank">ë¼ì¿ í… ë¡œë˜7 í˜ì´ì§€</a>ì—ì„œ <b>ë¡œê·¸ì¸</b> í•˜ì„¸ìš”<br>
    2. ë¡œê·¸ì¸ í›„ ì•„ë˜ ë²„íŠ¼ í´ë¦­ â†’ ìƒˆ íƒ­ì—ì„œ ê²°ì œ í™•ì¸<br>
    3. ì´ 3íšŒ ë°˜ë³µ (50ì¥ Ã— 3 = 150ì¥ = 45,000ì›)
  </div>

  <div class="info">
    <strong>ğŸ“Š ì¼ë³¸ ì „ë¬¸ê°€ ê¸°ì¤€ 100% ì¶©ì¡± (ç¬¬663å› ê¸°ì¤€)</strong><br>
    åˆè¨ˆ 100-185: 100% | å¶å¥‡ 2:5~5:2: 100% | å¼•ã£å¼µã‚Š: 99.3% | é€£ç¶šæ•°å­—: 55.3% | ä¸‹ä¸€æ¡å…±é€š: 100%<br>
    ë°±í…ŒìŠ¤íŠ¸: 6ê°œì¼ì¹˜ 4íšŒ, 5ê°œì¼ì¹˜ 30íšŒ
  </div>

  <!-- ë‹¹ì²¨ í™•ì¸ ì„¹ì…˜ -->
  <div class="check-section">
    <h2>ğŸ° ë‹¹ì²¨ í™•ì¸</h2>
    <p>ë‹¹ì²¨ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê³  í™•ì¸ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš” (ë¡œë˜7: 7ê°œ ë³¸ìˆ«ì + ë³´ë„ˆìŠ¤ 2ê°œ)</p>
    <div class="number-input">
      <label>ë³¸1<input type="number" id="num1" min="1" max="37" placeholder=""></label>
      <label>ë³¸2<input type="number" id="num2" min="1" max="37" placeholder=""></label>
      <label>ë³¸3<input type="number" id="num3" min="1" max="37" placeholder=""></label>
      <label>ë³¸4<input type="number" id="num4" min="1" max="37" placeholder=""></label>
      <label>ë³¸5<input type="number" id="num5" min="1" max="37" placeholder=""></label>
      <label>ë³¸6<input type="number" id="num6" min="1" max="37" placeholder=""></label>
      <label>ë³¸7<input type="number" id="num7" min="1" max="37" placeholder=""></label>
      <label>ë³´1<input type="number" id="bonus1" min="1" max="37" placeholder="" class="bonus"></label>
      <label>ë³´2<input type="number" id="bonus2" min="1" max="37" placeholder="" class="bonus"></label>
    </div>
    <button class="check-btn" onclick="checkWinning()">ğŸ” ë‹¹ì²¨ í™•ì¸í•˜ê¸°</button>
    <div id="results"></div>
  </div>

  <div class="progress" id="progress"></div>

  <div id="batches"></div>

  <script>
    const allTickets = [
      [9,11,14,20,30,34,36],[9,15,17,20,22,30,34],[7,10,12,17,22,30,35],[4,12,16,23,26,29,35],[2,9,13,22,30,34,36],
      [2,4,12,23,26,31,34],[2,12,15,22,27,30,34],[1,4,12,15,22,32,34],[7,12,15,18,20,35,37],[7,9,11,18,21,30,34],
      [4,7,12,21,29,32,35],[7,10,12,26,29,35,37],[9,12,15,18,22,30,37],[1,7,12,20,22,30,34],[4,12,19,26,29,32,34],
      [7,10,15,17,20,29,35],[7,12,20,22,26,33,35],[2,9,12,15,22,31,36],[4,7,11,14,22,30,34],[2,4,9,21,23,30,34],
      [4,7,13,23,26,29,34],[7,10,15,18,21,30,35],[2,9,12,20,30,34,37],[4,7,12,20,29,31,34],[7,11,15,20,27,30,34],
      [7,9,15,18,20,24,30],[7,10,14,20,29,34,36],[7,12,15,22,29,31,35],[9,12,15,17,22,32,35],[4,7,10,17,20,30,34],
      [1,11,15,22,30,34,36],[2,4,15,19,22,34,36],[2,7,14,23,30,34,36],[7,9,20,22,27,34,36],[4,7,12,16,23,32,34],
      [4,12,15,19,23,32,35],[12,15,18,24,26,29,35],[4,7,10,12,23,33,35],[4,8,11,15,21,30,34],[2,9,11,15,19,30,34],
      [9,11,15,18,31,34,36],[2,4,9,20,31,34,36],[7,9,11,17,22,30,36],[10,12,15,17,22,34,36],[2,4,12,27,29,34,36],
      [2,4,12,19,22,26,35],[4,7,12,16,18,29,36],[2,7,15,17,20,34,36],[1,4,11,23,26,30,34],[7,10,14,20,26,30,35],
      [4,7,20,24,26,29,35],[4,7,11,21,23,26,35],[4,12,15,21,23,29,34],[7,10,12,21,23,30,34],[7,9,12,17,22,29,34],
      [9,12,20,22,26,31,34],[7,10,12,15,20,31,36],[4,7,11,23,31,34,36],[7,9,11,20,30,35,37],[2,9,15,20,27,30,36],
      [5,9,12,22,30,32,34],[4,10,12,17,20,26,35],[7,12,15,18,22,27,36],[7,9,11,20,24,26,34],[2,9,12,15,21,32,34],
      [4,12,15,18,22,33,35],[9,13,15,18,23,30,34],[4,12,13,22,23,30,34],[12,13,15,22,23,26,35],[1,4,7,22,23,34,35],
      [7,12,13,18,22,34,35],[7,14,15,20,22,34,35],[9,12,13,22,26,29,30],[7,9,10,20,21,30,36],[2,4,14,15,23,34,35],
      [10,12,13,15,18,35,36],[7,8,15,21,23,34,35],[7,9,20,21,29,34,35],[4,12,13,18,26,32,35],[8,9,14,15,22,34,36],
      [4,10,12,13,29,34,35],[12,14,15,20,29,30,34],[7,9,12,21,22,23,35],[9,15,18,21,22,34,35],[7,10,12,18,30,36,37],
      [4,7,11,20,33,34,35],[4,8,12,21,22,34,35],[1,12,22,26,29,34,35],[7,12,15,21,22,30,32],[8,9,20,21,26,30,34],
      [12,15,17,20,23,34,35],[2,4,12,13,23,35,36],[7,12,15,17,18,29,30],[7,12,20,21,26,29,30],[9,10,12,14,29,30,36],
      [2,15,20,21,30,34,35],[7,11,15,17,18,34,35],[7,8,9,15,20,34,37],[7,12,14,23,29,34,35],[2,5,12,22,34,35,36],
      [8,9,12,15,18,24,36],[4,13,20,22,26,34,35],[4,9,15,22,23,31,34],[7,10,14,15,22,30,36],[2,12,15,18,19,34,35],
      [8,9,11,12,24,30,34],[7,12,22,23,26,27,34],[1,9,12,22,23,34,36],[9,12,13,20,22,35,36],[4,15,17,22,29,34,35],
      [2,4,26,28,29,34,35],[2,9,14,15,20,26,34],[7,10,11,24,30,34,36],[9,14,22,23,26,30,34],[7,15,18,19,29,35,36],
      [9,15,17,18,20,35,36],[1,4,12,18,29,30,34],[7,8,12,18,21,35,36],[8,9,12,18,26,35,37],[5,7,12,22,29,30,36],
      [8,9,12,21,22,30,36],[4,8,9,13,23,34,35],[2,4,7,29,30,33,34],[4,9,13,20,29,30,34],[4,7,8,20,21,34,36],
      [7,10,18,20,24,35,36],[7,8,12,15,18,31,34],[4,8,9,12,31,32,34],[7,12,15,16,26,29,32],[7,9,12,29,30,32,37],
      [1,8,9,15,29,30,34],[7,9,10,22,30,31,34],[7,15,17,22,23,35,36],[8,9,11,18,30,36,37],[11,12,17,22,26,30,34],
      [9,12,18,21,29,30,35],[12,13,15,18,20,26,30],[4,10,12,26,29,30,33],[4,12,13,20,26,29,36],[10,13,15,22,30,34,35],
      [4,7,8,16,29,34,35],[7,11,15,20,21,35,36],[11,12,13,18,22,30,36],[4,12,21,22,23,26,32],[8,12,13,15,32,34,35],
      [9,10,12,17,18,30,34],[9,12,15,18,19,26,32],[7,10,12,13,22,26,36],[1,4,15,18,20,34,35],[4,10,15,21,32,34,35]
    ];

    // ë¡œë˜7 panel í˜•ì‹: R + ë²ˆí˜¸ë“¤ + ,0,1,1
    function formatPanel(ticket) {
      return ticket.map(n => 'R' + n).join(',') + ',0,1,1';
    }

    const batchSize = 50;
    const numBatches = Math.ceil(allTickets.length / batchSize);

    // ì§„í–‰ í‘œì‹œ
    const progressDiv = document.getElementById('progress');
    for (let i = 0; i < numBatches; i++) {
      const item = document.createElement('span');
      item.className = 'progress-item';
      item.id = `prog-${i}`;
      item.textContent = `${i + 1}ì°¨`;
      progressDiv.appendChild(item);
    }

    // ë°°ì¹˜ ìƒì„±
    const batchesDiv = document.getElementById('batches');

    for (let batchIdx = 0; batchIdx < numBatches; batchIdx++) {
      const start = batchIdx * batchSize;
      const end = Math.min((batchIdx + 1) * batchSize, allTickets.length);
      const batchTickets = allTickets.slice(start, end);
      const totalPrice = batchTickets.length * 300; // ë¡œë˜7ì€ 300ì—”

      const batchDiv = document.createElement('div');
      batchDiv.className = 'batch';

      let ticketList = batchTickets.map((t, i) =>
        `<div class="ticket-line">${start + i + 1}. ${t.join(', ')}</div>`
      ).join('');

      batchDiv.innerHTML = `
        <h3>ğŸ“¦ ${batchIdx + 1}ì°¨ êµ¬ë§¤ (${start + 1}~${end}ë²ˆ)</h3>
        <p><b>${batchTickets.length}ì¥</b> Ã— 300ì› = <b>${totalPrice.toLocaleString()}ì›</b></p>
        <button onclick="submitBatch(${batchIdx})" id="btn-${batchIdx}">ğŸš€ ${batchIdx + 1}ì°¨ ì œì¶œ (${batchTickets.length}ì¥)</button>
        <div class="tickets">${ticketList}</div>
        <form id="form-${batchIdx}" method="POST" action="https://takarakuji.rakuten.co.jp/loto/alert_purchase/" target="_blank" style="display:none;"></form>
      `;

      batchesDiv.appendChild(batchDiv);

      // í¼ í•„ë“œ ìƒì„±
      const form = document.getElementById(`form-${batchIdx}`);

      // ê¸°ë³¸ í•„ë“œ (ë¡œë˜7ì€ loto_type: 7, unit_price: 300)
      const fields = {
        'loto_type': '7',
        'unit_price': '300',
        'vote_continuation_flag': '1',
        'professional': '0',
        'auto_vote': '0',
        'total_price': String(totalPrice)
      };

      for (const [name, value] of Object.entries(fields)) {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = name;
        input.value = value;
        form.appendChild(input);
      }

      // íŒ¨ë„ ì¶”ê°€
      batchTickets.forEach((ticket, idx) => {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = `panel[${idx}]`;
        input.value = formatPanel(ticket);
        form.appendChild(input);
      });
    }

    function submitBatch(batchIdx) {
      const form = document.getElementById(`form-${batchIdx}`);
      form.submit();

      const btn = document.getElementById(`btn-${batchIdx}`);
      btn.textContent = 'âœ“ ì œì¶œë¨';
      btn.classList.add('done');

      document.getElementById(`prog-${batchIdx}`).classList.add('done');
    }

    // ë‹¹ì²¨ í™•ì¸ ê¸°ëŠ¥
    function checkWinning() {
      // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
      const mainNumbers = [];
      for (let i = 1; i <= 7; i++) {
        const val = parseInt(document.getElementById(`num${i}`).value);
        if (isNaN(val) || val < 1 || val > 37) {
          alert(`ë³¸ìˆ«ì ${i}ì„(ë¥¼) ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš” (1~37)`);
          return;
        }
        mainNumbers.push(val);
      }
      const bonusNumbers = [];
      for (let i = 1; i <= 2; i++) {
        const val = parseInt(document.getElementById(`bonus${i}`).value);
        if (isNaN(val) || val < 1 || val > 37) {
          alert(`ë³´ë„ˆìŠ¤ ìˆ«ì ${i}ì„(ë¥¼) ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš” (1~37)`);
          return;
        }
        bonusNumbers.push(val);
      }

      // ë‹¹ì²¨ ê²°ê³¼ ê³„ì‚°
      // ë¡œë˜7 ë‹¹ì²¨ ê¸°ì¤€:
      // 1ë“±: 7ê°œ ì¼ì¹˜
      // 2ë“±: 6ê°œ + ë³´ë„ˆìŠ¤ 2ê°œ ì¤‘ 1ê°œ ì´ìƒ
      // 3ë“±: 6ê°œ ì¼ì¹˜
      // 4ë“±: 5ê°œ ì¼ì¹˜
      // 5ë“±: 4ê°œ ì¼ì¹˜
      // 6ë“±: 3ê°œ + ë³´ë„ˆìŠ¤ 1ê°œ ì´ìƒ
      const results = {
        1: [], // 1ë“±: 7ê°œ ì¼ì¹˜
        2: [], // 2ë“±: 6ê°œ + ë³´ë„ˆìŠ¤
        3: [], // 3ë“±: 6ê°œ ì¼ì¹˜
        4: [], // 4ë“±: 5ê°œ ì¼ì¹˜
        5: [], // 5ë“±: 4ê°œ ì¼ì¹˜
        6: []  // 6ë“±: 3ê°œ + ë³´ë„ˆìŠ¤
      };

      const prizes = {
        1: 600000000, // ì•½ 6ì–µì—”
        2: 7300000,   // ì•½ 730ë§Œì—”
        3: 730000,    // ì•½ 73ë§Œì—”
        4: 9100,      // ì•½ 9,100ì—”
        5: 1400,      // ì•½ 1,400ì—”
        6: 1000       // ì•½ 1,000ì—”
      };

      allTickets.forEach((ticket, idx) => {
        // ë³¸ìˆ«ìì™€ ì¼ì¹˜í•˜ëŠ” ê°œìˆ˜
        const matchedMain = ticket.filter(n => mainNumbers.includes(n));
        const matchCount = matchedMain.length;

        // ë³´ë„ˆìŠ¤ ìˆ«ì ì¼ì¹˜ ê°œìˆ˜
        const matchedBonus = ticket.filter(n => bonusNumbers.includes(n));
        const bonusCount = matchedBonus.length;

        let rank = 0;
        if (matchCount === 7) {
          rank = 1; // 1ë“±
        } else if (matchCount === 6 && bonusCount >= 1) {
          rank = 2; // 2ë“±
        } else if (matchCount === 6) {
          rank = 3; // 3ë“±
        } else if (matchCount === 5) {
          rank = 4; // 4ë“±
        } else if (matchCount === 4) {
          rank = 5; // 5ë“±
        } else if (matchCount === 3 && bonusCount >= 1) {
          rank = 6; // 6ë“±
        }

        if (rank > 0) {
          results[rank].push({
            index: idx + 1,
            ticket: ticket,
            matchedNumbers: matchedMain,
            matchedBonus: matchedBonus,
            bonusCount: bonusCount
          });
        }
      });

      // ê²°ê³¼ í‘œì‹œ
      displayResults(results, prizes, mainNumbers, bonusNumbers);
    }

    // ìŠ¤í¬ë˜ì¹˜ ë°ì´í„° ì €ì¥ìš© ì „ì—­ ë³€ìˆ˜
    let currentScratchIndex = 0;
    let allScratchTicketsData = [];
    let allResultsData = {};
    let mainNumbersData = [];
    let prizesData = {};

    function displayResults(results, prizes, mainNumbers, bonusNumbers) {
      const resultsDiv = document.getElementById('results');

      // ëª¨ë“  ë‹¹ì²¨ í‹°ì¼“ì„ ìŠ¤í¬ë˜ì¹˜ ì¹´ë“œìš©ìœ¼ë¡œ ì¤€ë¹„ (1ë“±~6ë“± ìˆœì„œëŒ€ë¡œ)
      const allScratchTickets = [
        ...results[1].map(t => ({...t, rank: 1})),
        ...results[2].map(t => ({...t, rank: 2})),
        ...results[3].map(t => ({...t, rank: 3})),
        ...results[4].map(t => ({...t, rank: 4})),
        ...results[5].map(t => ({...t, rank: 5})),
        ...results[6].map(t => ({...t, rank: 6}))
      ];

      // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
      currentScratchIndex = 0;
      allScratchTicketsData = allScratchTickets;
      allResultsData = results;
      mainNumbersData = mainNumbers;
      prizesData = prizes;

      // ë“±ìˆ˜ë³„ ê°¯ìˆ˜ ê³„ì‚°
      const highPrizeCount = results[1].length + results[2].length + results[3].length;
      const count4 = results[4].length;
      const count5 = results[5].length;
      const count6 = results[6].length;

      let html = '<div class="results">';

      // ë‹¹ì²¨ë²ˆí˜¸ í‘œì‹œ
      html += `<div style="text-align:center; margin-bottom:15px; padding:10px; background:#e3f2fd; border-radius:8px;">
        <strong>ë‹¹ì²¨ë²ˆí˜¸:</strong> ${mainNumbers.join(' - ')} + <span style="color:#ff9800; font-weight:bold;">${bonusNumbers.join(', ')}</span>
      </div>`;

      // ìš”ì•½ ì¹´ë“œ (ê° ì¹´ë“œì— ë¯¸ë‹ˆ ìŠ¤í¬ë˜ì¹˜)
      html += '<div class="result-summary">';

      // 1~3ë“± ê³ ì•¡ë‹¹ì²¨ ì¹´ë“œ
      html += `<div class="result-card" style="background: linear-gradient(135deg, #9c27b0 0%, #673ab7 100%); color: white;">
        <h4 style="color:white;">ğŸ† 1~3ë“±</h4>
        <div class="mini-scratch" id="mini-scratch-high">
          <div class="mini-scratch-content" style="background: linear-gradient(135deg, #e1bee7 0%, #ce93d8 100%); color: #4a148c;">${highPrizeCount}ì¥</div>
          <canvas class="mini-scratch-canvas" id="mini-canvas-high" width="70" height="35"></canvas>
        </div>
        <div class="prize" style="color:rgba(255,255,255,0.9);">73ë§Œ~6ì–µì—”</div>
      </div>`;

      // 4ë“±
      html += `<div class="result-card" style="background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white;">
        <h4 style="color:white;">ğŸ¯ 4ë“±</h4>
        <div class="mini-scratch" id="mini-scratch-4">
          <div class="mini-scratch-content" style="background: linear-gradient(135deg, #ffe0b2 0%, #ffcc80 100%); color: #e65100;">${count4}ì¥</div>
          <canvas class="mini-scratch-canvas" id="mini-canvas-4" width="70" height="35"></canvas>
        </div>
        <div class="prize" style="color:rgba(255,255,255,0.9);">9,100ì—”</div>
      </div>`;

      // 5ë“±
      html += `<div class="result-card" style="background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%); color: white;">
        <h4 style="color:white;">ğŸ« 5ë“±</h4>
        <div class="mini-scratch" id="mini-scratch-5">
          <div class="mini-scratch-content" style="background: linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%); color: #1b5e20;">${count5}ì¥</div>
          <canvas class="mini-scratch-canvas" id="mini-canvas-5" width="70" height="35"></canvas>
        </div>
        <div class="prize" style="color:rgba(255,255,255,0.9);">1,400ì—”</div>
      </div>`;

      // 6ë“±
      html += `<div class="result-card" style="background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%); color: white;">
        <h4 style="color:white;">ğŸŸï¸ 6ë“±</h4>
        <div class="mini-scratch" id="mini-scratch-6">
          <div class="mini-scratch-content" style="background: linear-gradient(135deg, #bbdefb 0%, #90caf9 100%); color: #0d47a1;">${count6}ì¥</div>
          <canvas class="mini-scratch-canvas" id="mini-canvas-6" width="70" height="35"></canvas>
        </div>
        <div class="prize" style="color:rgba(255,255,255,0.9);">1,000ì—”</div>
      </div>`;

      html += '</div>';

      // ë‹¹ì²¨ í‹°ì¼“ ìƒì„¸ ìŠ¤í¬ë˜ì¹˜ ì¹´ë“œ ì„¹ì…˜
      html += `<div class="scratch-section">
        <h4>ğŸ° ë‹¹ì²¨ í‹°ì¼“ ìƒì„¸ í™•ì¸</h4>
        <p style="text-align:center; color:#aaa; font-size:12px; margin-bottom:15px;">ì¹´ë“œë¥¼ ê¸ì–´ì„œ ë‹¹ì²¨ í‹°ì¼“ì„ í™•ì¸í•˜ì„¸ìš”!</p>
        <div class="scratch-cards" id="scratch-cards-container">`;

      // ì²« ë²ˆì§¸ ìŠ¤í¬ë˜ì¹˜ ì¹´ë“œ (ë˜ëŠ” ê½)
      html += createScratchCardHtml(0, allScratchTickets, results, mainNumbers);

      html += `</div>
        <button class="reveal-all-btn" id="next-scratch-btn" onclick="showNextScratchCard()">ğŸ« ë‹¤ìŒ ë‹¹ì²¨ê¶Œ í™•ì¸</button>
        <p id="scratch-progress" style="text-align:center; color:#aaa; font-size:12px; margin-top:10px;">1 / ?</p>
      </div>`;

      html += '</div>';
      resultsDiv.innerHTML = html;

      // DOM ì—…ë°ì´íŠ¸ í›„ ë¯¸ë‹ˆ ìŠ¤í¬ë˜ì¹˜ ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
      setTimeout(() => {
        initMiniScratchCard('mini-canvas-high', 'mini-scratch-high');
        initMiniScratchCard('mini-canvas-4', 'mini-scratch-4');
        initMiniScratchCard('mini-canvas-5', 'mini-scratch-5');
        initMiniScratchCard('mini-canvas-6', 'mini-scratch-6');
        initScratchCard(0);
      }, 100);
    }

    // ë¯¸ë‹ˆ ìŠ¤í¬ë˜ì¹˜ ì¹´ë“œ ì´ˆê¸°í™” (ê°¯ìˆ˜ í‘œì‹œìš©)
    function initMiniScratchCard(canvasId, containerId) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;

      const ctx = canvas.getContext('2d');
      let isDrawing = false;
      let lastX = 0;
      let lastY = 0;

      // ì€ìƒ‰ ìŠ¤í¬ë˜ì¹˜ í‘œë©´ ê·¸ë¦¬ê¸°
      const gradient = ctx.createLinearGradient(0, 0, 70, 35);
      gradient.addColorStop(0, '#c0c0c0');
      gradient.addColorStop(0.5, '#d8d8d8');
      gradient.addColorStop(1, '#b0b0b0');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, 70, 35);

      // ? í‘œì‹œ
      ctx.fillStyle = '#666';
      ctx.font = 'bold 16px sans-serif';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText('?ì¥', 35, 18);

      // ê¸ê¸° ì„¤ì •
      ctx.globalCompositeOperation = 'destination-out';
      ctx.lineWidth = 18;
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';

      function getPosition(e) {
        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;

        if (e.touches) {
          return {
            x: (e.touches[0].clientX - rect.left) * scaleX,
            y: (e.touches[0].clientY - rect.top) * scaleY
          };
        }
        return {
          x: (e.clientX - rect.left) * scaleX,
          y: (e.clientY - rect.top) * scaleY
        };
      }

      function startDrawing(e) {
        e.preventDefault();
        e.stopPropagation();
        isDrawing = true;
        const pos = getPosition(e);
        lastX = pos.x;
        lastY = pos.y;
      }

      function draw(e) {
        if (!isDrawing) return;
        e.preventDefault();
        e.stopPropagation();

        const pos = getPosition(e);

        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();

        lastX = pos.x;
        lastY = pos.y;

        // ê¸ì€ ë¹„ìœ¨ ì²´í¬
        checkMiniScratchPercent(canvas, canvasId);
      }

      function stopDrawing() {
        isDrawing = false;
      }

      // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
      canvas.addEventListener('mousedown', startDrawing);
      canvas.addEventListener('mousemove', draw);
      canvas.addEventListener('mouseup', stopDrawing);
      canvas.addEventListener('mouseleave', stopDrawing);

      // í„°ì¹˜ ì´ë²¤íŠ¸
      canvas.addEventListener('touchstart', startDrawing, { passive: false });
      canvas.addEventListener('touchmove', draw, { passive: false });
      canvas.addEventListener('touchend', stopDrawing);

      // ìº”ë²„ìŠ¤ ì´ˆê¸°í™” ì™„ë£Œ í›„ ì½˜í…ì¸  í‘œì‹œ
      const container = document.getElementById(containerId);
      if (container) {
        const content = container.querySelector('.mini-scratch-content');
        if (content) {
          content.classList.add('ready');
        }
      }
    }

    // ë¯¸ë‹ˆ ìŠ¤í¬ë˜ì¹˜ ê¸ì€ ë¹„ìœ¨ ì²´í¬
    function checkMiniScratchPercent(canvas, canvasId) {
      const ctx = canvas.getContext('2d');
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const pixels = imageData.data;
      let transparentPixels = 0;

      for (let i = 3; i < pixels.length; i += 4) {
        if (pixels[i] === 0) {
          transparentPixels++;
        }
      }

      const totalPixels = pixels.length / 4;
      const percent = (transparentPixels / totalPixels) * 100;

      if (percent > 50) {
        canvas.style.opacity = '0';
        canvas.style.transition = 'opacity 0.3s ease';
      }
    }

    // ìŠ¤í¬ë˜ì¹˜ ì¹´ë“œ HTML ìƒì„±
    function createScratchCardHtml(idx, allScratchTickets, results, mainNumbers) {
      const rankNames = {1: 'ğŸ¥‡ 1ë“±', 2: 'ğŸ¥ˆ 2ë“±', 3: 'ğŸ¥‰ 3ë“±', 4: 'ğŸ¯ 4ë“±', 5: 'ğŸ« 5ë“±', 6: 'ğŸŸï¸ 6ë“±'};
      const rankPrizes = {1: 'ì•½ 6ì–µì—”', 2: 'ì•½ 730ë§Œì—”', 3: 'ì•½ 73ë§Œì—”', 4: 'ì•½ 9,100ì—”', 5: 'ì•½ 1,400ì—”', 6: 'ì•½ 1,000ì—”'};
      const rankColors = {
        1: '#e74c3c',
        2: '#e74c3c',
        3: '#e74c3c',
        4: '#ff9800',
        5: '#4caf50',
        6: '#2196f3'
      };
      const rankBgColors = {
        1: 'linear-gradient(135deg, #fff9c4 0%, #fff176 100%)',
        2: 'linear-gradient(135deg, #fff9c4 0%, #fff176 100%)',
        3: 'linear-gradient(135deg, #fff9c4 0%, #fff176 100%)',
        4: 'linear-gradient(135deg, #ffe0b2 0%, #ffcc80 100%)',
        5: 'linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%)',
        6: 'linear-gradient(135deg, #bbdefb 0%, #90caf9 100%)'
      };

      // ë‹¹ì²¨ì´ ì—†ê±°ë‚˜ ì¸ë±ìŠ¤ë¥¼ ì´ˆê³¼í•œ ê²½ìš° ê½
      if (!allScratchTickets || allScratchTickets.length === 0 || idx >= allScratchTickets.length) {
        return `<div class="scratch-card" id="scratch-card-${idx}">
          <div class="scratch-content" style="background: linear-gradient(135deg, #bdc3c7 0%, #95a5a6 100%);">
            <div class="rank-text" style="font-size: 36px;">ê½...</div>
            <div class="prize" style="color:#7f8c8d; font-weight:bold;">ë‹¤ìŒ ê¸°íšŒì—!</div>
            <div class="ticket-info" style="color:#95a5a6;">ë‹¹ì²¨ ì—†ìŒ</div>
          </div>
          <canvas class="scratch-canvas" id="scratch-canvas-${idx}" width="280" height="120"></canvas>
        </div>`;
      }

      const win = allScratchTickets[idx];
      const winRank = win.rank;

      const ticketDisplay = win.ticket.map(n => {
        if (mainNumbers.includes(n)) {
          return `<span class="matched">${n}</span>`;
        }
        return n;
      }).join(', ');

      return `<div class="scratch-card" id="scratch-card-${idx}" data-rank="${winRank}">
        <div class="scratch-content" style="background: ${rankBgColors[winRank]};">
          <div class="rank-text">${rankNames[winRank]}</div>
          <div class="prize" style="color:${rankColors[winRank]}; font-weight:bold;">${rankPrizes[winRank]}</div>
          <div class="ticket-info">#${win.index}ë²ˆ í‹°ì¼“</div>
          <div class="numbers-text">[${ticketDisplay}]</div>
        </div>
        <canvas class="scratch-canvas" id="scratch-canvas-${idx}" width="280" height="120"></canvas>
      </div>`;
    }

    // ë‹¤ìŒ ìŠ¤í¬ë˜ì¹˜ ì¹´ë“œ í‘œì‹œ
    function showNextScratchCard() {
      currentScratchIndex++;

      const container = document.getElementById('scratch-cards-container');
      const progressEl = document.getElementById('scratch-progress');
      const nextBtn = document.getElementById('next-scratch-btn');

      // ê¸°ì¡´ ì¹´ë“œ ìˆ¨ê¸°ê¸° (ìº”ë²„ìŠ¤ ì œê±°)
      const prevCanvas = document.getElementById(`scratch-canvas-${currentScratchIndex - 1}`);
      if (prevCanvas) {
        prevCanvas.style.opacity = '0';
      }

      // ìƒˆ ì¹´ë“œ ì¶”ê°€
      const newCardHtml = createScratchCardHtml(currentScratchIndex, allScratchTicketsData, allResultsData, mainNumbersData);
      container.innerHTML = newCardHtml;

      // ìƒˆ ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
      setTimeout(() => {
        initScratchCard(currentScratchIndex);
      }, 100);

      // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
      const totalCards = allScratchTicketsData.length > 0 ? allScratchTicketsData.length : 1;
      const displayIdx = Math.min(currentScratchIndex + 1, totalCards + 1);
      progressEl.textContent = `${displayIdx} / ?`;

      // ë‹¹ì²¨ì´ ì—†ê±°ë‚˜ ë§ˆì§€ë§‰ ê½ ì¹´ë“œë¥¼ ë³´ì—¬ì¤€ ê²½ìš° ë²„íŠ¼ ìˆ¨ê¸°ê¸°
      if (allScratchTicketsData.length === 0) {
        // ê½ë§Œ ìˆëŠ” ê²½ìš° ë²„íŠ¼ ìˆ¨ê¸°ê¸°
        nextBtn.style.display = 'none';
        progressEl.textContent = 'ë‹¹ì²¨ ì—†ìŒ';
      } else if (currentScratchIndex >= allScratchTicketsData.length) {
        // ëª¨ë“  ë‹¹ì²¨ í™•ì¸ í›„ ë§ˆì§€ë§‰ ê½ ì¹´ë“œ
        nextBtn.style.display = 'none';
        // ë“±ìˆ˜ë³„ í†µê³„ í‘œì‹œ
        const stats = [];
        for (let r = 1; r <= 6; r++) {
          if (allResultsData[r].length > 0) {
            stats.push(`${r}ë“±: ${allResultsData[r].length}ì¥`);
          }
        }
        progressEl.textContent = `ëª¨ë‘ í™•ì¸ ì™„ë£Œ! (${stats.join(', ')})`;
      }
    }

    // ìŠ¤í¬ë˜ì¹˜ ì¹´ë“œ ì´ˆê¸°í™”
    function initScratchCard(idx) {
      const canvas = document.getElementById(`scratch-canvas-${idx}`);
      if (!canvas) return;

      const ctx = canvas.getContext('2d');
      let isDrawing = false;
      let lastX = 0;
      let lastY = 0;

      // ì€ìƒ‰ ìŠ¤í¬ë˜ì¹˜ í‘œë©´ ê·¸ë¦¬ê¸°
      const gradient = ctx.createLinearGradient(0, 0, 280, 120);
      gradient.addColorStop(0, '#c0c0c0');
      gradient.addColorStop(0.3, '#d8d8d8');
      gradient.addColorStop(0.5, '#a8a8a8');
      gradient.addColorStop(0.7, '#c8c8c8');
      gradient.addColorStop(1, '#b0b0b0');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, 280, 120);

      // ìŠ¤í¬ë˜ì¹˜ í…ìŠ¤íŠ¸
      ctx.fillStyle = '#666';
      ctx.font = 'bold 14px sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText('ğŸ« ê³ ì•¡ë‹¹ì²¨!', 140, 50);
      ctx.font = '12px sans-serif';
      ctx.fillText('ê¸ì–´ì„œ í™•ì¸í•˜ì„¸ìš”', 140, 75);

      // ê¸ê¸° ì„¤ì •
      ctx.globalCompositeOperation = 'destination-out';
      ctx.lineWidth = 40;
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';

      function getPosition(e) {
        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;

        if (e.touches) {
          return {
            x: (e.touches[0].clientX - rect.left) * scaleX,
            y: (e.touches[0].clientY - rect.top) * scaleY
          };
        }
        return {
          x: (e.clientX - rect.left) * scaleX,
          y: (e.clientY - rect.top) * scaleY
        };
      }

      function startDrawing(e) {
        e.preventDefault();
        isDrawing = true;
        const pos = getPosition(e);
        lastX = pos.x;
        lastY = pos.y;
      }

      function draw(e) {
        if (!isDrawing) return;
        e.preventDefault();

        const pos = getPosition(e);

        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();

        lastX = pos.x;
        lastY = pos.y;

        // ê¸ì€ ë¹„ìœ¨ ì²´í¬
        checkScratchPercent(canvas, idx);
      }

      function stopDrawing() {
        isDrawing = false;
      }

      // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
      canvas.addEventListener('mousedown', startDrawing);
      canvas.addEventListener('mousemove', draw);
      canvas.addEventListener('mouseup', stopDrawing);
      canvas.addEventListener('mouseleave', stopDrawing);

      // í„°ì¹˜ ì´ë²¤íŠ¸
      canvas.addEventListener('touchstart', startDrawing, { passive: false });
      canvas.addEventListener('touchmove', draw, { passive: false });
      canvas.addEventListener('touchend', stopDrawing);

      // ìº”ë²„ìŠ¤ ì´ˆê¸°í™” ì™„ë£Œ í›„ ì½˜í…ì¸  í‘œì‹œ
      const card = document.getElementById(`scratch-card-${idx}`);
      if (card) {
        const content = card.querySelector('.scratch-content');
        if (content) {
          content.classList.add('ready');
        }
      }
    }

    // ê¸ì€ ë¹„ìœ¨ ì²´í¬ (60% ì´ìƒ ê¸ìœ¼ë©´ ìë™ ê³µê°œ)
    function checkScratchPercent(canvas, idx) {
      const ctx = canvas.getContext('2d');
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const pixels = imageData.data;
      let transparentPixels = 0;

      for (let i = 3; i < pixels.length; i += 4) {
        if (pixels[i] === 0) {
          transparentPixels++;
        }
      }

      const totalPixels = pixels.length / 4;
      const percent = (transparentPixels / totalPixels) * 100;

      if (percent > 60) {
        // ì™„ì „íˆ ê³µê°œ
        canvas.style.opacity = '0';
        canvas.style.transition = 'opacity 0.3s ease';
      }
    }
  </script>
</body>
</html>
